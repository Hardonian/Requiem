{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "allowlist_version": "1.0.0",
  "description": "Approved dependency allowlist for all Requiem layers. Any dependency not listed here blocks merge via scripts/verify_deps.sh. Add new dependencies here with justification before adding them to package.json or CMakeLists.txt.",
  "last_updated": "2026-02-27",

  "cpp_vendored": [
    {
      "name": "blake3",
      "version": "vendored",
      "license": "CC0-1.0 / Apache-2.0",
      "justification": "Primary hash algorithm for all content-addressed operations. Vendored for deterministic builds.",
      "files": ["third_party/blake3/"]
    }
  ],

  "cpp_system_optional": [
    {
      "name": "libzstd",
      "version": ">=1.4.0",
      "license": "BSD",
      "justification": "Optional compression for CAS objects. Build falls back gracefully when absent.",
      "cmake_flag": "REQUIEM_WITH_ZSTD"
    },
    {
      "name": "libssl / openssl",
      "version": ">=1.1.0",
      "license": "Apache-2.0 (OpenSSL 3.x) / OpenSSL license (1.x)",
      "justification": "Required for TLS in production builds. Optional in test builds.",
      "cmake_flag": "optional"
    }
  ],

  "node_runtime": [
    {
      "name": "next",
      "version": "14.2.3",
      "license": "MIT",
      "justification": "Core Next.js framework for ReadyLayer Cloud dashboard."
    },
    {
      "name": "react",
      "version": "^18.3.1",
      "license": "MIT",
      "justification": "React UI library, required by Next.js."
    },
    {
      "name": "react-dom",
      "version": "^18.3.1",
      "license": "MIT",
      "justification": "React DOM renderer, required by Next.js."
    }
  ],

  "node_dev": [
    {
      "name": "@types/node",
      "version": "^20",
      "license": "MIT",
      "justification": "TypeScript types for Node.js."
    },
    {
      "name": "@types/react",
      "version": "^18",
      "license": "MIT",
      "justification": "TypeScript types for React."
    },
    {
      "name": "@types/react-dom",
      "version": "^18",
      "license": "MIT",
      "justification": "TypeScript types for React DOM."
    },
    {
      "name": "typescript",
      "version": "^5",
      "license": "Apache-2.0",
      "justification": "TypeScript compiler for type checking."
    }
  ],

  "policy": {
    "new_dependency_process": [
      "1. Add entry to this file with name, version, license, and justification.",
      "2. Add to the appropriate package.json or CMakeLists.txt.",
      "3. Run scripts/verify_deps.sh locally to confirm it passes.",
      "4. PR must include: 'Dependency-Added: <name>@<version> license=<spdx>'"
    ],
    "prohibited_licenses": [
      "GPL-2.0", "GPL-3.0", "AGPL-3.0",
      "SSPL-1.0", "Commons-Clause"
    ],
    "allowed_copyleft_with_review": ["LGPL-2.1", "LGPL-3.0", "MPL-2.0"],
    "max_major_versions_per_package": 1,
    "version_pin_policy": "Runtime deps must be pinned to exact or caret range. No '*' or 'latest'."
  }
}
